/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py:289: InformationOnly: Normalizing '3.0.0.b1' to '3.0.0b1'
  self.metadata.version = self._normalize_version(self.metadata.version)


torch.__version__  = 2.4.0+cu121


running install
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  self.initialize_options()
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py:66: EasyInstallDeprecationWarning: easy_install command is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` and ``easy_install``.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://github.com/pypa/setuptools/issues/917 for details.
        ********************************************************************************

!!
  self.initialize_options()
running bdist_egg
running egg_info
creating flashattn_hopper.egg-info
writing flashattn_hopper.egg-info/PKG-INFO
writing dependency_links to flashattn_hopper.egg-info/dependency_links.txt
writing requirements to flashattn_hopper.egg-info/requires.txt
writing top-level names to flashattn_hopper.egg-info/top_level.txt
writing manifest file 'flashattn_hopper.egg-info/SOURCES.txt'
reading manifest file 'flashattn_hopper.egg-info/SOURCES.txt'
writing manifest file 'flashattn_hopper.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
creating build
creating build/lib.linux-x86_64-cpython-312
copying flash_attn_interface.py -> build/lib.linux-x86_64-cpython-312
running build_ext
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py:414: UserWarning: The detected CUDA version (12.3) has a minor version mismatch with the version that was used to compile PyTorch (12.1). Most likely this shouldn't be a problem.
  warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no g++ version bounds defined for CUDA version 12.3
  warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
building 'flashattn_hopper_cuda' extension
creating /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312
Emitting ninja build file /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/build.ninja...
Compiling objects...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[1/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
FAILED: /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o 
/usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_launch_template.h(96): error: identifier "smem_size" is undefined
      if (smem_size >= 48 * 1024) {
          ^

1 error detected in the compilation of "/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_bf16_sm90.cu".
[2/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
FAILED: /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o 
/usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_launch_template.h(96): error: identifier "smem_size" is undefined
      if (smem_size >= 48 * 1024) {
          ^

1 error detected in the compilation of "/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_fp16_sm90.cu".
[3/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
FAILED: /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o 
/usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_launch_template.h(96): error: identifier "smem_size" is undefined
      if (smem_size >= 48 * 1024) {
          ^

1 error detected in the compilation of "/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_bf16_sm90.cu".
[4/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
FAILED: /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o 
/usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_launch_template.h(96): error: identifier "smem_size" is undefined
      if (smem_size >= 48 * 1024) {
          ^

1 error detected in the compilation of "/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_fp16_sm90.cu".
[5/9] c++ -MMD -MF /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_api.o.d -pthread -B /home/lidong1/miniconda3/envs/yuqxia/compiler_compat -fno-strict-overflow -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /home/lidong1/miniconda3/envs/yuqxia/include -fPIC -O2 -isystem /home/lidong1/miniconda3/envs/yuqxia/include -fPIC -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_api.cpp -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_api.o -O3 -std=c++17 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
[6/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_bwd_hdim64_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 104 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 104 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 128 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 128 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 176 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 176 bytes
ptxas info    : 162 bytes gmem
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    32 bytes stack frame, 32 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    32 bytes stack frame, 32 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    104 bytes stack frame, 112 bytes spill stores, 112 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    104 bytes stack frame, 112 bytes spill stores, 112 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    128 bytes stack frame, 136 bytes spill stores, 148 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    128 bytes stack frame, 136 bytes spill stores, 148 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_6half_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_6half_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 64 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    176 bytes stack frame, 228 bytes spill stores, 236 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEENS_6half_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_26SM90_64x64x16_F32F16F16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJNS5_ILi2EEESL_SL_EEENS4_IJSL_NS5_ILi0EEESZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEENS_6half_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_26SM90_64x64x16_F32F16F16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJNS5_ILi2EEESL_SL_EEENS4_IJSL_NS5_ILi0EEESZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 58 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    176 bytes stack frame, 228 bytes spill stores, 236 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_6half_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_6half_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 64 registers
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h: In function ‘void cutlass::device_kernel(typename Operator::Params) [with Operator = flash::FlashAttnBwdPostprocessConvertdQ<cute::tuple<cute::C<128>, cute::C<64> >, cutlass::half_t, float, cutlass::arch::Sm90, 256, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<32>, cute::Layout<cute::tuple<cute::C<256>, cute::C<32> >, cute::tuple<cute::C<32>, cute::C<1> > > >, cute::TiledMMA<cute::MMA_Atom<cute::SM90_64x64x16_F32F16F16_SS<cute::GMMA::Major::K, cute::GMMA::Major::MN, cute::GMMA::ScaleIn::One, cute::GMMA::ScaleIn::One> >, cute::Layout<cute::tuple<cute::C<2>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, false>]’:
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h:104:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
  104 | void device_kernel(CUTLASS_GRID_CONSTANT typename Operator::Params const params)
      | ^~~~~~~~~~~~~
[7/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_bwd_hdim64_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 104 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 104 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 128 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 128 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 176 bytes
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 176 bytes
ptxas info    : 162 bytes gmem
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    32 bytes stack frame, 32 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    32 bytes stack frame, 32 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    104 bytes stack frame, 112 bytes spill stores, 112 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    104 bytes stack frame, 112 bytes spill stores, 112 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    128 bytes stack frame, 136 bytes spill stores, 148 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    128 bytes stack frame, 136 bytes spill stores, 148 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 64 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    176 bytes stack frame, 228 bytes spill stores, 236 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_28SM90_64x64x16_F32BF16BF16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJNS5_ILi2EEESL_SL_EEENS4_IJSL_NS5_ILi0EEESZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_28SM90_64x64x16_F32BF16BF16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJNS5_ILi2EEESL_SL_EEENS4_IJSL_NS5_ILi0EEESZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 58 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi128EEES9_NS6_ILi64EEEEEESB_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi2EEENS1_21CollectiveEpilogueBwdISB_SB_SC_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    176 bytes stack frame, 228 bytes spill stores, 236 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi128EEENS5_ILi64EEEEEES8_NS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 64 registers
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h: In function ‘void cutlass::device_kernel(typename Operator::Params) [with Operator = flash::FlashAttnBwdPostprocessConvertdQ<cute::tuple<cute::C<128>, cute::C<64> >, cutlass::bfloat16_t, float, cutlass::arch::Sm90, 256, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<32>, cute::Layout<cute::tuple<cute::C<256>, cute::C<32> >, cute::tuple<cute::C<32>, cute::C<1> > > >, cute::TiledMMA<cute::MMA_Atom<cute::SM90_64x64x16_F32BF16BF16_SS<cute::GMMA::Major::K, cute::GMMA::Major::MN, cute::GMMA::ScaleIn::One, cute::GMMA::ScaleIn::One> >, cute::Layout<cute::tuple<cute::C<2>, cute::C<1>, cute::C<1> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, false>]’:
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h:104:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
  104 | void device_kernel(CUTLASS_GRID_CONSTANT typename Operator::Params const params)
      | ^~~~~~~~~~~~~
[8/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_bwd_qkdim128_vdim256_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 832 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 824 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 656 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 664 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 848 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 848 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 672 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 680 bytes
ptxas info    : 162 bytes gmem
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    832 bytes stack frame, 952 bytes spill stores, 956 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    824 bytes stack frame, 948 bytes spill stores, 948 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    656 bytes stack frame, 780 bytes spill stores, 780 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    664 bytes stack frame, 788 bytes spill stores, 788 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    848 bytes stack frame, 1684 bytes spill stores, 1704 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    848 bytes stack frame, 1684 bytes spill stores, 1704 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 122 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    672 bytes stack frame, 1500 bytes spill stores, 1524 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_28SM90_64x64x16_F32BF16BF16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJSL_NS5_ILi2EEESL_EEENS4_IJNS5_ILi0EEESL_SZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_28SM90_64x64x16_F32BF16BF16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJSL_NS5_ILi2EEESL_EEENS4_IJNS5_ILi0EEESL_SZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 58 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    680 bytes stack frame, 1504 bytes spill stores, 1528 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_10bfloat16_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 120 registers
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h: In function ‘void cutlass::device_kernel(typename Operator::Params) [with Operator = flash::FlashAttnBwdPostprocessConvertdQ<cute::tuple<cute::C<64>, cute::C<128> >, cutlass::bfloat16_t, float, cutlass::arch::Sm90, 256, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<32>, cute::Layout<cute::tuple<cute::C<256>, cute::C<32> >, cute::tuple<cute::C<32>, cute::C<1> > > >, cute::TiledMMA<cute::MMA_Atom<cute::SM90_64x64x16_F32BF16BF16_SS<cute::GMMA::Major::K, cute::GMMA::Major::MN, cute::GMMA::ScaleIn::One, cute::GMMA::ScaleIn::One> >, cute::Layout<cute::tuple<cute::C<1>, cute::C<2>, cute::C<1> >, cute::tuple<cute::C<0>, cute::C<1>, cute::C<0> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, false>]’:
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h:104:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
  104 | void device_kernel(CUTLASS_GRID_CONSTANT typename Operator::Params const params)
      | ^~~~~~~~~~~~~
[9/9] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_bwd_qkdim128_vdim256_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 832 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 824 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 656 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 664 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 848 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 848 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 672 bytes
ptxas info    : (C7512) Potential Performance Loss: wgmma.mma_async instructions are serialized due to insufficient register resources for the function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE'
ptxas warning : Local memory used for function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE', size of stack frame: 680 bytes
ptxas info    : 162 bytes gmem
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    832 bytes stack frame, 952 bytes spill stores, 956 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    824 bytes stack frame, 948 bytes spill stores, 948 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    656 bytes stack frame, 780 bytes spill stores, 780 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb0ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    664 bytes stack frame, 788 bytes spill stores, 788 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    848 bytes stack frame, 1684 bytes spill stores, 1704 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb0EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    848 bytes stack frame, 1684 bytes spill stores, 1704 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 106 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb0ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    672 bytes stack frame, 1500 bytes spill stores, 1524 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS_6half_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_26SM90_64x64x16_F32F16F16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJSL_NS5_ILi2EEESL_EEENS4_IJNS5_ILi0EEESL_SZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash32FlashAttnBwdPostprocessConvertdQIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS_6half_tEfNS_4arch4Sm90ELi256ENS3_14ComposedLayoutINS3_7SwizzleILi3ELi4ELi3EEENS3_18smem_ptr_flag_bitsILi32EEENS3_6LayoutINS4_IJNS5_ILi256EEENS5_ILi32EEEEEENS4_IJSJ_NS5_ILi1EEEEEEEEEENS3_8TiledMMAINS3_8MMA_AtomIJNS3_26SM90_64x64x16_F32F16F16_SSILNS3_4GMMA5MajorE0ELST_1ELNSS_7ScaleInE1ELSU_1EEEEEENSH_INS4_IJSL_NS5_ILi2EEESL_EEENS4_IJNS5_ILi0EEESL_SZ_EEEEENS4_IJNS3_10UnderscoreES12_S12_EEEEELb0EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 58 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash12FlashAttnBwdINS1_21CollectiveMainloopBwdILi1EN4cute5tupleIJNS4_1CILi1EEES7_S7_EEENS5_IJNS6_ILi64EEENS6_ILi128EEESA_EEENS5_IJS9_SA_NS6_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1ELb1ELb0ELb0ELi1ELi2ELi1EEENS1_21CollectiveEpilogueBwdISB_SD_SE_Li256ELb1EEENS1_22SingleTileSchedulerBwdEEEEEvNT_6ParamsE
    680 bytes stack frame, 1504 bytes spill stores, 1528 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE' for 'sm_90a'
ptxas info    : Function properties for _ZN7cutlass13device_kernelIN5flash22FlashAttnBwdPreprocessIN4cute5tupleIJNS3_1CILi64EEENS5_ILi128EEEEEENS4_IJS6_NS5_ILi256EEEEEENS_6half_tEfNS_4arch4Sm90ELb1ELb1EEEEEvNT_6ParamsE
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 106 registers
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h: In function ‘void cutlass::device_kernel(typename Operator::Params) [with Operator = flash::FlashAttnBwdPostprocessConvertdQ<cute::tuple<cute::C<64>, cute::C<128> >, cutlass::half_t, float, cutlass::arch::Sm90, 256, cute::ComposedLayout<cute::Swizzle<3, 4, 3>, cute::smem_ptr_flag_bits<32>, cute::Layout<cute::tuple<cute::C<256>, cute::C<32> >, cute::tuple<cute::C<32>, cute::C<1> > > >, cute::TiledMMA<cute::MMA_Atom<cute::SM90_64x64x16_F32F16F16_SS<cute::GMMA::Major::K, cute::GMMA::Major::MN, cute::GMMA::ScaleIn::One, cute::GMMA::ScaleIn::One> >, cute::Layout<cute::tuple<cute::C<1>, cute::C<2>, cute::C<1> >, cute::tuple<cute::C<0>, cute::C<1>, cute::C<0> > >, cute::tuple<cute::Underscore, cute::Underscore, cute::Underscore> >, false>]’:
/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include/cutlass/device_kernel.h:104:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
  104 | void device_kernel(CUTLASS_GRID_CONSTANT typename Operator::Params const params)
      | ^~~~~~~~~~~~~
ninja: build stopped: subcommand failed.
Traceback (most recent call last):
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py", line 2105, in _run_ninja_build
    subprocess.run(
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lidong1/yuqxia/customized-flash-attention/hopper/setup.py", line 263, in <module>
    setup(
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/__init__.py", line 108, in setup
    return distutils.core.setup(**attrs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/core.py", line 184, in setup
    return run_commands(dist)
           ^^^^^^^^^^^^^^^^^^
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/core.py", line 200, in run_commands
    dist.run_commands()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/dist.py", line 970, in run_commands
    self.run_command(cmd)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py", line 945, in run_command
    super().run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/dist.py", line 989, in run_command
    cmd_obj.run()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/install.py", line 92, in run
    self.do_egg_install()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/install.py", line 144, in do_egg_install
    self.run_command('bdist_egg')
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py", line 316, in run_command
    self.distribution.run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py", line 945, in run_command
    super().run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/dist.py", line 989, in run_command
    cmd_obj.run()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/bdist_egg.py", line 167, in run
    cmd = self.call_command('install_lib', warn_dir=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/bdist_egg.py", line 153, in call_command
    self.run_command(cmdname)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py", line 316, in run_command
    self.distribution.run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py", line 945, in run_command
    super().run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/dist.py", line 989, in run_command
    cmd_obj.run()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/install_lib.py", line 13, in run
    self.build()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/command/install_lib.py", line 110, in build
    self.run_command('build_ext')
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py", line 316, in run_command
    self.distribution.run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py", line 945, in run_command
    super().run_command(command)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/dist.py", line 989, in run_command
    cmd_obj.run()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/build_ext.py", line 93, in run
    _build_ext.run(self)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/command/build_ext.py", line 359, in run
    self.build_extensions()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py", line 866, in build_extensions
    build_ext.build_extensions(self)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/command/build_ext.py", line 479, in build_extensions
    self._build_extensions_serial()
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/command/build_ext.py", line 505, in _build_extensions_serial
    self.build_extension(ext)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/command/build_ext.py", line 254, in build_extension
    _build_ext.build_extension(self, ext)
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/command/build_ext.py", line 560, in build_extension
    objects = self.compiler.compile(
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py", line 679, in unix_wrap_ninja_compile
    _write_ninja_file_and_compile_objects(
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py", line 1785, in _write_ninja_file_and_compile_objects
    _run_ninja_build(
  File "/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py", line 2121, in _run_ninja_build
    raise RuntimeError(message) from e
RuntimeError: Error compiling objects for extension
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/dist.py:289: InformationOnly: Normalizing '3.0.0.b1' to '3.0.0b1'
  self.metadata.version = self._normalize_version(self.metadata.version)


torch.__version__  = 2.4.0+cu121


running install
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  self.initialize_options()
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_distutils/cmd.py:66: EasyInstallDeprecationWarning: easy_install command is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` and ``easy_install``.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://github.com/pypa/setuptools/issues/917 for details.
        ********************************************************************************

!!
  self.initialize_options()
running bdist_egg
running egg_info
writing flashattn_hopper.egg-info/PKG-INFO
writing dependency_links to flashattn_hopper.egg-info/dependency_links.txt
writing requirements to flashattn_hopper.egg-info/requires.txt
writing top-level names to flashattn_hopper.egg-info/top_level.txt
reading manifest file 'flashattn_hopper.egg-info/SOURCES.txt'
writing manifest file 'flashattn_hopper.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
copying flash_attn_interface.py -> build/lib.linux-x86_64-cpython-312
running build_ext
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py:414: UserWarning: The detected CUDA version (12.3) has a minor version mismatch with the version that was used to compile PyTorch (12.1). Most likely this shouldn't be a problem.
  warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no g++ version bounds defined for CUDA version 12.3
  warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
building 'flashattn_hopper_cuda' extension
Emitting ninja build file /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/build.ninja...
Compiling objects...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[1/4] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 80 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas info    : 138 bytes gmem
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    80 bytes stack frame, 80 bytes spill stores, 104 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 24 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 128 registers
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h: In function ‘void flash::compute_attn_ws(typename flash::CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params, typename flash::CollectiveEpilogueFwd<Ktraits, Seqlen_traits>::Params, typename TileScheduler::Params, Seqlen_traits, Seqlen_traits) [with Ktraits = Flash_fwd_kernel_traits<64, 64, 192, 128, 16, 2, false, 1, cutlass::bfloat16_t>; bool Is_causal = true; TileScheduler = flash::SingleTileScheduler; Seqlen_traits = flash::SeqLenTraits<true>]’:
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h:29:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
   29 |     compute_attn_ws(CUTE_GRID_CONSTANT typename CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params const mainloop_params,
      | ^   ~~~~~~~~~~~
[2/4] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_hdim64_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 80 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas info    : 138 bytes gmem
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi384ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    80 bytes stack frame, 80 bytes spill stores, 104 bytes spill loads
ptxas info    : Used 128 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi64ELi64ELi192ELi128ELi16ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 24 bytes spill stores, 32 bytes spill loads
ptxas info    : Used 128 registers
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h: In function ‘void flash::compute_attn_ws(typename flash::CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params, typename flash::CollectiveEpilogueFwd<Ktraits, Seqlen_traits>::Params, typename TileScheduler::Params, Seqlen_traits, Seqlen_traits) [with Ktraits = Flash_fwd_kernel_traits<64, 64, 192, 128, 16, 2, false, 1, cutlass::half_t>; bool Is_causal = true; TileScheduler = flash::SingleTileScheduler; Seqlen_traits = flash::SeqLenTraits<true>]’:
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h:29:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
   29 |     compute_attn_ws(CUTE_GRID_CONSTANT typename CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params const mainloop_params,
      | ^   ~~~~~~~~~~~
[3/4] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_bf16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 16 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 32 bytes
ptxas info    : 258 bytes gmem
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    16 bytes stack frame, 16 bytes spill stores, 28 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 28 bytes spill stores, 36 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    32 bytes stack frame, 40 bytes spill stores, 44 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    24 bytes stack frame, 20 bytes spill stores, 24 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 28 bytes spill stores, 44 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass10bfloat16_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    32 bytes stack frame, 40 bytes spill stores, 52 bytes spill loads
ptxas info    : Used 168 registers
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h: In function ‘void flash::compute_attn_ws(typename flash::CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params, typename flash::CollectiveEpilogueFwd<Ktraits, Seqlen_traits>::Params, typename TileScheduler::Params, Seqlen_traits, Seqlen_traits) [with Ktraits = Flash_fwd_kernel_traits<128, 256, 128, 80, 12, 2, false, 2, cutlass::bfloat16_t>; bool Is_causal = true; TileScheduler = flash::SingleTileScheduler; Seqlen_traits = flash::SeqLenTraits<true>]’:
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h:29:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
   29 |     compute_attn_ws(CUTE_GRID_CONSTANT typename CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params const mainloop_params,
      | ^   ~~~~~~~~~~~
[4/4] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o.d -I/home/lidong1/yuqxia/customized-flash-attention/csrc/cutlass/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/TH -I/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda/include -I/home/lidong1/miniconda3/envs/yuqxia/include/python3.12 -c -c /home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_qkdim128_vdim256_fp16_sm90.cu -o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_BFLOAT16_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ -U__CUDA_NO_BFLOAT162_OPERATORS__ -U__CUDA_NO_BFLOAT162_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math --ptxas-options=-v --ptxas-options=--verbose,--register-usage-level=10,--warn-on-local-memory-usage -lineinfo -DCUTLASS_DEBUG_TRACE_LEVEL=0 -DNDEBUG -gencode arch=compute_90a,code=sm_90a --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flashattn_hopper_cuda -D_GLIBCXX_USE_CXX11_ABI=0
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 16 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 32 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 24 bytes
ptxas warning : Local memory used for function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_', size of stack frame: 32 bytes
ptxas info    : 258 bytes gmem
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb0ENS_29StaticPersistentTileSchedulerENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    16 bytes stack frame, 16 bytes spill stores, 28 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb0ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 28 bytes spill stores, 36 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    32 bytes stack frame, 40 bytes spill stores, 44 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_30DynamicPersistentTileSchedulerILi256ELi32EEENS_12SeqLenTraitsILb0EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdISA_SB_E6ParamsENT1_6ParamsESB_SB_
    24 bytes stack frame, 20 bytes spill stores, 24 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi1EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    24 bytes stack frame, 28 bytes spill stores, 44 bytes spill loads
ptxas info    : Used 168 registers
ptxas info    : Compiling entry function '_ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_' for 'sm_90a'
ptxas info    : Function properties for _ZN5flash15compute_attn_wsI23Flash_fwd_kernel_traitsILi128ELi256ELi128ELi80ELi12ELi2ELb0ELi2EN7cutlass6half_tEELb1ENS_19SingleTileSchedulerENS_12SeqLenTraitsILb1EEEEEvNS_21CollectiveMainloopFwdIT_XT0_ET2_E6ParamsENS_21CollectiveEpilogueFwdIS9_SA_E6ParamsENT1_6ParamsESA_SA_
    32 bytes stack frame, 40 bytes spill stores, 52 bytes spill loads
ptxas info    : Used 168 registers
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h: In function ‘void flash::compute_attn_ws(typename flash::CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params, typename flash::CollectiveEpilogueFwd<Ktraits, Seqlen_traits>::Params, typename TileScheduler::Params, Seqlen_traits, Seqlen_traits) [with Ktraits = Flash_fwd_kernel_traits<128, 256, 128, 80, 12, 2, false, 2, cutlass::half_t>; bool Is_causal = true; TileScheduler = flash::SingleTileScheduler; Seqlen_traits = flash::SeqLenTraits<true>]’:
/home/lidong1/yuqxia/customized-flash-attention/hopper/flash_fwd_kernel.h:29:1: note: the ABI for passing parameters with 64-byte alignment has changed in GCC 4.6
   29 |     compute_attn_ws(CUTE_GRID_CONSTANT typename CollectiveMainloopFwd<Ktraits, Is_causal, Seqlen_traits>::Params const mainloop_params,
      | ^   ~~~~~~~~~~~
g++ -pthread -B /home/lidong1/miniconda3/envs/yuqxia/compiler_compat -shared -Wl,-rpath,/home/lidong1/miniconda3/envs/yuqxia/lib -Wl,-rpath-link,/home/lidong1/miniconda3/envs/yuqxia/lib -L/home/lidong1/miniconda3/envs/yuqxia/lib -Wl,-rpath,/home/lidong1/miniconda3/envs/yuqxia/lib -Wl,-rpath-link,/home/lidong1/miniconda3/envs/yuqxia/lib -L/home/lidong1/miniconda3/envs/yuqxia/lib /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_api.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_bf16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_hdim64_fp16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_bf16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_bwd_qkdim128_vdim256_fp16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_bf16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_hdim64_fp16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_bf16_sm90.o /home/lidong1/yuqxia/customized-flash-attention/hopper/build/temp.linux-x86_64-cpython-312/flash_fwd_qkdim128_vdim256_fp16_sm90.o -L/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/torch/lib -L/usr/local/cuda/lib64 -lcuda -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-312/flashattn_hopper_cuda.cpython-312-x86_64-linux-gnu.so
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
copying build/lib.linux-x86_64-cpython-312/flash_attn_interface.py -> build/bdist.linux-x86_64/egg
copying build/lib.linux-x86_64-cpython-312/flashattn_hopper_cuda.cpython-312-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg
byte-compiling build/bdist.linux-x86_64/egg/flash_attn_interface.py to flash_attn_interface.cpython-312.pyc
creating stub loader for flashattn_hopper_cuda.cpython-312-x86_64-linux-gnu.so
byte-compiling build/bdist.linux-x86_64/egg/flashattn_hopper_cuda.py to flashattn_hopper_cuda.cpython-312.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying flashattn_hopper.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying flashattn_hopper.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying flashattn_hopper.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying flashattn_hopper.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying flashattn_hopper.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
writing build/bdist.linux-x86_64/egg/EGG-INFO/native_libs.txt
zip_safe flag not set; analyzing archive contents...
__pycache__.flashattn_hopper_cuda.cpython-312: module references __file__
creating dist
creating 'dist/flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg
removing '/home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg' (and everything under it)
creating /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg
Extracting flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg to /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Adding flashattn-hopper 3.0.0b1 to easy-install.pth file

Installed /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/flashattn_hopper-3.0.0b1-py3.12-linux-x86_64.egg
Processing dependencies for flashattn-hopper==3.0.0b1
Searching for ninja==1.11.1.1
Best match: ninja 1.11.1.1
Adding ninja 1.11.1.1 to easy-install.pth file
Installing ninja script to /home/lidong1/miniconda3/envs/yuqxia/bin

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for packaging==24.1
Best match: packaging 24.1
Adding packaging 24.1 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_vendor
Searching for einops==0.8.0
Best match: einops 0.8.0
Processing einops-0.8.0-py3.12.egg
Adding einops 0.8.0 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/einops-0.8.0-py3.12.egg
Searching for torch==2.4.0
Best match: torch 2.4.0
Adding torch 2.4.0 to easy-install.pth file
Installing convert-caffe2-to-onnx script to /home/lidong1/miniconda3/envs/yuqxia/bin
Installing convert-onnx-to-caffe2 script to /home/lidong1/miniconda3/envs/yuqxia/bin
Installing torchrun script to /home/lidong1/miniconda3/envs/yuqxia/bin

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for triton==3.0.0
Best match: triton 3.0.0
Adding triton 3.0.0 to easy-install.pth file
Installing proton script to /home/lidong1/miniconda3/envs/yuqxia/bin
Installing proton-viewer script to /home/lidong1/miniconda3/envs/yuqxia/bin

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-nvtx-cu12==12.1.105
Best match: nvidia-nvtx-cu12 12.1.105
Adding nvidia-nvtx-cu12 12.1.105 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-nccl-cu12==2.20.5
Best match: nvidia-nccl-cu12 2.20.5
Adding nvidia-nccl-cu12 2.20.5 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cusparse-cu12==12.1.0.106
Best match: nvidia-cusparse-cu12 12.1.0.106
Adding nvidia-cusparse-cu12 12.1.0.106 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cusolver-cu12==11.4.5.107
Best match: nvidia-cusolver-cu12 11.4.5.107
Adding nvidia-cusolver-cu12 11.4.5.107 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-curand-cu12==10.3.2.106
Best match: nvidia-curand-cu12 10.3.2.106
Adding nvidia-curand-cu12 10.3.2.106 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cufft-cu12==11.0.2.54
Best match: nvidia-cufft-cu12 11.0.2.54
Adding nvidia-cufft-cu12 11.0.2.54 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cublas-cu12==12.1.3.1
Best match: nvidia-cublas-cu12 12.1.3.1
Adding nvidia-cublas-cu12 12.1.3.1 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cudnn-cu12==9.1.0.70
Best match: nvidia-cudnn-cu12 9.1.0.70
Adding nvidia-cudnn-cu12 9.1.0.70 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cuda-cupti-cu12==12.1.105
Best match: nvidia-cuda-cupti-cu12 12.1.105
Adding nvidia-cuda-cupti-cu12 12.1.105 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cuda-runtime-cu12==12.1.105
Best match: nvidia-cuda-runtime-cu12 12.1.105
Adding nvidia-cuda-runtime-cu12 12.1.105 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-cuda-nvrtc-cu12==12.1.105
Best match: nvidia-cuda-nvrtc-cu12 12.1.105
Adding nvidia-cuda-nvrtc-cu12 12.1.105 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for setuptools==72.1.0
Best match: setuptools 72.1.0
Adding setuptools 72.1.0 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for fsspec==2024.6.1
Best match: fsspec 2024.6.1
Adding fsspec 2024.6.1 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for jinja2==3.1.4
Best match: jinja2 3.1.4
Adding jinja2 3.1.4 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for networkx==3.3
Best match: networkx 3.3
Adding networkx 3.3 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for sympy==1.13.2
Best match: sympy 1.13.2
Adding sympy 1.13.2 to easy-install.pth file
Installing isympy script to /home/lidong1/miniconda3/envs/yuqxia/bin

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for typing-extensions==4.12.2
Best match: typing-extensions 4.12.2
typing-extensions 4.12.2 is already the active version in easy-install.pth

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages/setuptools/_vendor
Searching for filelock==3.15.4
Best match: filelock 3.15.4
Adding filelock 3.15.4 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for nvidia-nvjitlink-cu12==12.6.68
Best match: nvidia-nvjitlink-cu12 12.6.68
Adding nvidia-nvjitlink-cu12 12.6.68 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for MarkupSafe==2.1.5
Best match: MarkupSafe 2.1.5
Adding MarkupSafe 2.1.5 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Searching for mpmath==1.3.0
Best match: mpmath 1.3.0
Adding mpmath 1.3.0 to easy-install.pth file

Using /home/lidong1/miniconda3/envs/yuqxia/lib/python3.12/site-packages
Finished processing dependencies for flashattn-hopper==3.0.0b1
